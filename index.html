<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>

    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-15" />
    <meta http-equiv="content-language" content="en" />
    <meta http-equiv="pragma" content="no-cache" />

    <meta name="author" content="Roman Matthias Keil" />
    <meta name="publisher" content="Roman Matthias Keil" />
    <meta name="copyright" content="Roman Matthias Keil" />
    <meta name="owner" content="Roman Matthias Keil" />
    <meta name="date" content="2014-08-08" />

    <meta name="description" content="bewerbung.matthias-keil.de" />
    <meta name="keywords" content="treatjs, treat, treat js, js, online, javascript, contract" />
    <meta name="language" content="en" />
    <meta name="robots" content="index, follow" />
    <meta name="revisit-after" content="7 days" />

    <title>TreatJS | Online Version</title>

    <link rel="shortcut icon" type="image/x-icon" href="http://proglang.informatik.uni-freiburg.de/include/favicon.ico" />

    <link rel="stylesheet" type="text/css" href="stylesheets/template.css" media="all" />
    <link rel="stylesheet" type="text/css" href="stylesheets/content.css" media="all" />

  </head>
  <body>
    <div id="wrapper">
      <div id="headline_wrapper">
        <div id="headline" class="frame">
          <div id="title_wrapper">
            <div id="title">TreatJS: Higher-Order Contracts for JavaScript</div>
            <div id="subtitle">Online Version</div>
          </div>
        </div>
        <div id="navigation" class="frame">
          <ul>
            <li><a href="http://proglang.informatik.uni-freiburg.de/treatjs/">TreatJS Home</a></li>
            <li><a href="http://proglang.informatik.uni-freiburg.de/treatjs/api.html">Documentation</a></li>
            <li><a href="http://proglang.informatik.uni-freiburg.de/treatjs/example.html">TreatJS Sample Applications</a></li>
            <li><a href="http://proglang.informatik.uni-freiburg.de/treatjs/download.html">Download TreatJS</a></li>
          </ul>
          <div class="clear"></div>
        </div>
        <div id="logo"></div>
      </div>

      <div id="body" class="frame">	 
        <div id="content" >
          <p>
          <label for="input">Write your JavaScript program:</label>
          <textarea class="JavaScript" id="input" name="input" cols="" rows="20"></textarea>
          </p>

          <p>
          <button id="run" name="run" value="run">Run Code</button>
          <button id="link" name="link" value="link">Make Link</button>
          <button id="manual" name="manual" value="manual">Manual</button>
          <button id="contracts" name="contracts" value="contracts">Predefined Contracts</button>
          <button id="clean" name="clean" value="clean">Clean</button>
          </p>

          <p>
          <label for="output">Output:</label>
          <textarea id="output" name="output" cols="" rows="10" readonly="readonly">Error!</textarea>
          </p>

        </div>

        <div id="footline">

          <p>
          <a href="http://proglang.informatik.uni-freiburg.de/treatjs/">TreatJS: Higher-Order Contracts for JavaScript</a>, Version 1.2.10
          </p>

          <p>
          Copyright &copy; 2014, <a href="http://proglang.informatik.uni-freiburg.de/">Proglang</a>, <a href="http://www.uni-freiburg.de/start-en.html?set_language=en">University of Freiburg</a>.
          </p>

          <p>
          by <a href="http://www.informatik.uni-freiburg.de/~keilr/">Matthias Keil</a> and <a href="http://www.informatik.uni-freiburg.de/~thiemann/">Peter Thiemann</a>
          </p>

        </div>
      </div>
    </div>

    <script type="text/javascript">
      // get arguments from query string
      // http://www2.informatik.uni-freiburg.de/~keilr/treatjs/?code=

      //<![CDATA[
    var code = (function() {
        function getParams(key) { 
        var query = window.location.search.substring(1);
        var params = query.split('&');

        for (var i in params) {
        var param = params[i].split("=");
        if(param[0] == key) {
        return param[1];
        }
        }
        return "";
        }
        return getParams('code');

        })();
//]]>
</script>

<script type="text/javascript">
  // decode code or set default example
  // url encode
if(code !== "") document.getElementById('input').innerHTML = decodeURIComponent(code);
// default example
else document.getElementById('input').innerHTML = "function f ( x, y ) {\n return (x+y);\n}\n\nvar g = Contract.assert( f,\n   Contract.AFunction([typeOfNumber, typeOfNumber], typeOfNumber ) );\n\nreturn g ( 3, 5 );";
</script>

<script type="text/javascript">
  // test if proxy and weakmap are available 
if (typeof Proxy === "undefined") {
  document.getElementById('output').value = (new Error("Proxy not supported.").message);
} else if (typeof WeakMap === "undefined") {
  document.getElementById('output').value = (new Error("Proxy not supported.").message);
}
</script>

<!-- TreatJS -->
<script type="text/javascript" src="lib/lib_padding.js"></script>

<script type="text/javascript" src="treatjs_1.2.10/out.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/debugger.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/treat.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/treat.system.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/treat.base.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/treat.config.js"></script>

<script type="text/javascript" src="treatjs_1.2.10/core/treat.violation.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.sandbox.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.logic.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.callback.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.map.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.contract.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/core/treat.assert.js"></script>
<script type="text/javascript" src="treatjs_1.2.10/treat.canonicalize.js"></script>

<script type="text/javascript" src="treatjs_1.2.10/treat.convenience.js"></script>

<!-- TreatJS Sample Contracts -->
<script type="text/javascript">
  var thisArg = {};
</script>

<script type="text/javascript" src="contracts/contracts.js"></script>

<!-- Initialize TreatJS -->
<script type="text/javascript">

  // set configuration
TreatJS.configure({
assertion:true,
membrabe:true,
decompile:true,
canonicalize: true 
});

// set verbose
TreatJS.verbose({
assert:false,
sandbox:false
});

// clean output
function cleanup() {
  tjsout = "";
  exit = false;
  document.getElementById('output').value = "";
}

// extend string to output
function putstr(str) {
  document.getElementById('output').value += str;
}

// TreatJS print outpur
var tjsout = "";
function print(str) {
  if(!exit) tjsout += (str+"\n");
}

// TreatJS exit command
var exit = false;
function quit() {
  exit = true;
}

// handler
var handler = {
has : function(target, name) {
        return true;
      },
get : function(target, name, receiver) {
        return target[name];
      }
}

// target
TreatJS.export(thisArg);

// set bingings
var Contract = TreatJS.build();
thisArg.C = Contract;
thisArg.Contract = Contract;
thisArg.TreatJS = TreatJS;

// global object
var global = Proxy(thisArg, handler);

// evaluate input string
function evaluate(input) {
  var result = "";

  try {        
    var cmd = "with(global) { (function() {  \n" + input + "\n }); }";
    var sbxed = eval(cmd);
    result = sbxed.apply(global);
  } catch (e) {
    result = e.toString();
  }
  putstr((exit) ? tjsout : result);
}

document.getElementById('output').value = "";

</script>

<!-- Setup Run Code Button -->
<script type="text/javascript">
  (function() {

   // set on click action
   var run = document.getElementById('run');
   run.onclick = function() {

   // check if proxy exists
   if(Proxy===undefined) {
   var err = "Proxy is undefined!"
   document.getElementById('output').value = err;
   return;
   }

   // clean up
   cleanup();

   // evaluate input
   var input =  document.getElementById('input').value;
   evaluate(input);
   }
   })();
</script>

<!-- Setup Make Link Button -->
<script type="text/javascript">
  (function() {

   // set on click action
   var link = document.getElementById('link');
   link.onclick = function() {

   // clean up
   cleanup();

   // get input
   var input =  document.getElementById('input').value;
   var href = 'http://www2.informatik.uni-freiburg.de/~keilr/treatjs/?code='+encodeURIComponent(input);

   // print link
   putstr(href);

   }
   })();
</script>

<!-- Setup Manual Button -->
<script type="text/javascript">
  (function() {

   // set on click action
   var manual = document.getElementById('manual');
   manual.onclick = function() {

   // clean up
   cleanup();

   // print manual
   putstr(TreatJS.Manual);

   }
   })();
</script>

<!-- Setup Clean Button -->
<script type="text/javascript">
  (function() {

   // set on click action
   var contracts = document.getElementById('contracts');
   contracts.onclick = function() {

   // clean up
   cleanup();

   // print predefined contracts 
   putstr(TreatJS.Contracts);

   }
   })();
</script>

<!-- Setup Clean Button -->
<script type="text/javascript">
  (function() {

   // set on click action
   var clean = document.getElementById('clean');
   clean.onclick = function() {

   // clean up
   cleanup();

   }
   })();
</script>

   </body>
 </html>
